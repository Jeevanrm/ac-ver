---
- name: Install Tomcat
  hosts: localhost
  become: yes
  tasks:
    - name: Install Java
      apt:
        name: openjdk-17-jre-headless
        state: present
    - name: Download Tomcat
      get_url:
        url: https://dlcdn.apache.org/tomcat/tomcat-9/v9.0.89/bin/apache-tomcat-9.0.89.tar.gz
        dest: /opt/
    - name: Extract Tomcat
      unarchive:
        src: /opt/apache-tomcat-9.0.89.tar.gz
        dest: /opt/
          #remote_src: yes
    - name: tomcat user
      file:
        path: "/opt/apache-tomcat-9.0.89"
        state: directory
        owner: "ubuntu"
        group: "ubuntu"
          #recurse: yes
    - name: Start Tomcat Service
      shell: |
         cd /opt/apache-tomcat-9.0.89/bin/
         sh startup.sh
         #ps aux | grep tomcat
      register: local
    - name: debug
      debug:
        var: tomcat is "{{local.stdout_lines}}"
